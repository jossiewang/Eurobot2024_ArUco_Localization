import numpy as np
from scipy import linalg

# whole area
# b = np.array([[0.9, 0, 0],
#               [0.45,1.05,0],
#               [0.75, 0.6, 0],
#               [0.75, 1.05, 0],
#               [1.2, 1.05, 0],
#               [1.5, 1.05, 0],
#               [1.5, 0.75, 0],
#               [1.5, 0.3, 0],
#               [0, 0.85, 0]])

# tfed (whole area)
# A = np.array([[0.8623101962, -0.067624868, -0.2746952536],
#               [0.4167511544,1.012789115,-0.1489358065],
#               [0.7208727122,0.5574588293,-0.1895280865],
#               [0.7243381288,1.012310452,-0.1633824624],
#               [1.190174076,1.015501482,-0.1671963694],
#               [1.50022047,1.016471387,-0.166263543],
#               [1.491191279,0.7050533808,-0.1854114592],
#               [1.494170656,0.2466095346,-0.2293505477],
#               [-0.05575309326,0.8069195392,-0.1817071059]])

#raw (whole area)
# A = np.array([[-0.319879562,-0.7178722399,2.016335809],
#               [0.1228893641,0.3844603358,1.987129126],
#               [-0.1758036057,-0.08292779526,1.998265935],
#               [-0.1862928708,0.3782067299,1.992688968],
#               [-0.6500396591,0.369657223,1.999572736],
#               [-0.9594974615,0.3645625467,1.995734349],
#               [-0.9501708936,0.05289763974,1.988829396],
#               [-0.9508784277,-0.4160417607,2.006438545],
#               [0.5929896943,0.1913423816,1.992227733]])

# (left-up)
# b = np.array([[0.6, 1.05, 0],
#               [0.6, 0.75, 0],
#               [0.45, 0.6, 0],
#               [0.3, 1.05, 0],
#               [0.3, 0.75, 0],
#               [0.15, 1.05, 0],
#               [0.15, 0.9, 0],
#               [0, 0.85, 0]])

# #tfed (left-up)
# A = np.array([[0.5707900638,1.014199533,-0.1611195559],
#               [0.5706195263,0.7105719239,-0.1627840903],
#               [0.413010127,0.5581602864,-0.1738362146],
#               [0.2689050787,1.02159128,-0.1369666817],
#               [0.2608608737,0.7119825393,-0.1694432036],
#               [0.1099418251,1.027827993,-0.1497712499],
#               [0.1087730087,0.870112282,-0.1549387427],
#               [-0.05575309326,0.8069195392,-0.1817071059]])

# #(left-below)
# b = np.array([[0, 0.6, 0],
#               [0.15, 0.3, 0],
#               [0.3, 1.05, 0],
#               [0.3, 0, 0],
#               [0.45, 0.3, 0],
#               [0.6, 1.05, 0],
#               [0.6, 0, 0]])

# #tfed (left-below)
# A = np.array([[-0.06220496694,0.5506110653,-0.2082996091],
#               [0.09300941291,0.2470927886,-0.2058462293],
#               [0.2689050787,1.02159128,-0.1369666817],
#               [0.2393161994,-0.06600130208,-0.2373190314],
#               [0.3991069547,0.2411862271,-0.2253005927],
#               [0.5707900638,1.014199533,-0.1611195559],
#               [0.5478428921,-0.06344603198,-0.2424753122]])

# #(right-up)
# b = np.array([[0.75, 1.05, 0],
#               [0.75, 0.6, 0],
#               [0.9, 0.75, 0],
#               [1.05, 1.05, 0],
#               [1.05, 0.6, 0],
#               [1.2, 0.75, 0],
#               [1.35, 1.05, 0],
#               [1.5, 0.75, 0]])

# #tfed (right-up)
# A = np.array([[0.7243381288,1.012310452,-0.1633824624],
#               [0.7208727122,0.5574588293,-0.1895280865],
#               [0.8811571078,0.7115235631,-0.1926551522],
#               [1.036994785,1.017358635,-0.1726739632],
#               [1.030399158,0.555817363,-0.1969219011],
#               [1.187864859,0.7091522643,-0.1822864137],
#               [1.346753396,1.016917018,-0.1703268806],
#               [1.491191279,0.7050533808,-0.1854114592]])

#(right-below)
b = np.array([[0.75, 0.3, 0],
              [0.75, 0.6, 0],
              [0.9, 0, 0],
              [0.9, 0.45, 0],
              [1.05, 0.15, 0],
              [1.05, 0.6, 0],
              [1.5, 0.45, 0],
              [1.35, 0.6, 0]])

#tfed (right-below)
A = np.array([[0.7094171356,0.2400515351,-0.2342116079],
              [0.7208727122,0.5574588293,-0.1895280865],
              [0.8623101962,-0.067624868,-0.2746952536],
              [0.866661878,0.3943622252,-0.2166975059],
              [1.018015439,0.09229952793,-0.2367852205],
              [1.030399158,0.555817363,-0.1969219011],
              [1.496932603,0.4019018876,-0.2126300838],
              [1.336192107,0.550943692,-0.2005761198]])


p, *_ = linalg.lstsq(A, b)

D = A @ p
print(D)
# array([[ 0.96634906, -0.00256123,  0.        ],
#        [ 0.01068454,  0.99756876,  0.        ],
#        [-0.24550675, -0.25258789,  0.        ]])

# array([[-0.96768443, -0.02013843,  0.        ],
#        [-0.01115599,  0.96742494,  0.        ],
#        [ 0.28878065,  0.34058431,  0.        ]])

# array([[-0.96768443, -0.02013843,  0.        ],
#        [-0.01115599,  0.96742494,  0.        ],
#        [ 0.28878065,  0.34058431,  0.        ]])

